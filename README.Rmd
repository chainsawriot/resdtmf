---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# resdtmf

<!-- badges: start -->
<!-- badges: end -->

The goal of resdtmf is to create a machine-readable, plain-text and exchangable file format of document-term matrices (dtm, or document-feature matrices).

## Installation

And the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("chainsawriot/resdtmf")
```
## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
require(quanteda)
require(magrittr)
require(resdtmf)

quanteda::corpus(c('i love you', 'you love me', 'i hate you'),
                 docvars = data.frame(sentiment = c(1,1,0))) %>%
    quanteda::dfm() -> input_dfm
input_dfm
```

```{r}
export_resdtmf(input_dfm, "example.json")
```

The file is machine-readable.

```{r}
readLines("example.json")
```

It can be imported easily back into R.

```{r}
example_dfm <- import_resdtmf("example.json")
example_dfm
```

And the metadata is preserved.

```{r}
docvars(example_dfm)
```

```{r}
all.equal(example_dfm, input_dfm)
```

Example: serializing a DTM created using the `data_corpus_inaugural` data.

```{r}
inaugural_dfm <- dfm(data_corpus_inaugural)
export_resdtmf(inaugural_dfm, "inaug_dfm.json")
```

```{r}
inaugural_dfm_from_json <- import_resdtmf("inaug_dfm.json")
inaugural_dfm_from_json
```

```{r}
all.equal(inaugural_dfm, inaugural_dfm_from_json)
```

Using compression

```{r}
export_resdtmf(inaugural_dfm, "inaug_dfm2.json", compress = TRUE)
file.size("inaug_dfm.json")
file.size("inaug_dfm2.json.zip")
```

```{r}
inaugural_dfm_from_json_zip <- import_resdtmf("inaug_dfm2.json.zip")
all.equal(inaugural_dfm, inaugural_dfm_from_json_zip)
```

```{r, include = FALSE}
### Clean up
unlink("inaug_dfm2.json.zip")
unlink("inaug_dfm.json")
unlink("example.json")
```
